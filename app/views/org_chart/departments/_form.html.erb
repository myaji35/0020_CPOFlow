<%= form_with model: [:org_chart, @company, department], class: "space-y-4" do |f| %>
  <% if department.errors.any? %>
    <div class="rounded-lg bg-red-50 border border-red-200 px-4 py-3 text-red-800 text-sm">
      <ul class="list-disc list-inside space-y-1">
        <% department.errors.full_messages.each do |msg| %>
          <li><%= msg %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="grid grid-cols-2 gap-4">
    <div>
      <label class="block text-xs font-medium text-gray-600 mb-1">부서명</label>
      <%= f.text_field :name, class: "w-full border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/50", placeholder: "Engineering" %>
    </div>
    <div>
      <label class="block text-xs font-medium text-gray-600 mb-1">부서 코드</label>
      <%= f.text_field :code, class: "w-full border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/50", placeholder: "ENG" %>
    </div>
  </div>

  <% if @parent_departments.any? %>
    <div>
      <label class="block text-xs font-medium text-gray-600 mb-1">상위 부서 (선택)</label>
      <%= f.select :parent_id,
          @parent_departments.map { |d| [d.name, d.id] },
          { selected: department.parent_id, include_blank: "최상위 부서" },
          class: "w-full border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/50" %>
    </div>
  <% end %>

  <div>
    <label class="block text-xs font-medium text-gray-600 mb-1">정렬 순서</label>
    <%= f.number_field :sort_order, value: department.sort_order || 0, min: 0,
        class: "w-24 border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/50" %>
  </div>

  <% if department.persisted? %>
    <div class="flex items-center gap-2">
      <%= f.check_box :active, class: "rounded border-gray-300" %>
      <label class="text-sm text-gray-700">활성 부서</label>
    </div>
  <% end %>

  <div class="flex justify-end gap-2 pt-2">
    <%= link_to "취소", org_chart_company_path(@company), class: "px-4 py-2 border border-gray-200 text-gray-600 text-sm font-medium rounded-lg hover:bg-gray-50" %>
    <%= f.submit department.persisted? ? "저장" : "부서 추가", class: "px-4 py-2 bg-primary hover:bg-primary/90 text-white text-sm font-medium rounded-lg cursor-pointer transition-colors" %>
  </div>
<% end %>
